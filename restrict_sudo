#!/bin/bash

# Defining allowed sudo users
allowed_users=("arthur" "kali")

# Getting current sudo users
current_users=($(getent group sudo | cut -d: -f4 | tr ',' ' '))

# Checking current users using for loop
for user in "${current_users[@]}"; do
    if [[ ! " ${allowed_users[*]} " =~ " ${user} " ]]; then
        echo "[!] Unauthorized sudo user detected: $user"
        sudo deluser "$user" sudo
        echo "[+] Removed $user from sudo group"
    fi
done

echo "[âœ“] Sudo access checked and secured!"
