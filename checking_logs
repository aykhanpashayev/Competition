#!/bin/bash

# Define possible log file locations
logFile=""

if [[ -f "/var/log/auth.log" ]]; then
    logFile="/var/log/auth.log"
elif [[ -f "/var/log/secure" ]]; then
    logFile="/var/log/secure"
else
    echo "[!] Error: No authentication log file found!"
    exit 1
fi

echo "Monitoring sudo access in $logFile... Press Ctrl+C to stop."

# Live monitoring of sudo usage
sudo tail -fn0 "$logFile" | grep --line-buffered "sudo"

#Script for securing permissions on sudoers file

#!/bin/bash

echo "[+] Setting secure permissions on sudoers file..."
sudo chmod 440 /etc/sudoers
sudo chown root:root /etc/sudoers
echo "Sudoers file secured!"
